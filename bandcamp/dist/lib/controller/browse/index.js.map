{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/lib/controller/browse/index.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,4EAA6C;AAK7C,4FAAoE;AAEpE,MAAqB,gBAAgB;IAArC;;IAyCA,CAAC;IAvCC;;;;;;;;;;;;;;;OAeG;IACH,KAAK,CAAC,SAAS,CAAC,GAAW;QACzB,yBAAQ,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,gCAAgC,GAAG,EAAE,CAAC,CAAC;QAEjE,MAAM,OAAO,GAAG,uBAAA,IAAI,iEAAY,MAAhB,IAAI,EAAa,GAAG,CAAC,CAAC;QACtC,OAAO,OAAO,CAAC,MAAM,EAAE,CAAC;IAC1B,CAAC;IAED;;;;;OAKG;IACH,UAAU,CAAC,GAAW;QACpB,yBAAQ,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,iCAAiC,GAAG,EAAE,CAAC,CAAC;QAElE,MAAM,OAAO,GAAG,uBAAA,IAAI,iEAAY,MAAhB,IAAI,EAAa,GAAG,CAAC,CAAC;QACtC,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;CAKF;AAzCD,mCAyCC;kHAH6B,GAAW;IACrC,OAAO,4BAAkB,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC5C,CAAC","sourcesContent":["import bandcamp from '../../BandcampContext';\nimport BaseViewHandler from './view-handlers/BaseViewHandler';\nimport { ExplodedTrackInfo } from './view-handlers/ExplodableViewHandler';\nimport View from './view-handlers/View';\nimport { RenderedPage } from './view-handlers/ViewHandler';\nimport ViewHandlerFactory from './view-handlers/ViewHandlerFactory';\n\nexport default class BrowseController {\n\n  /*\n   *  Uri follows a hierarchical view structure, starting with 'bandcamp'.\n   * - If nothing follows 'bandcamp', the view would be 'root'.\n   *\n   * After 'bandcamp/', the uri consists of segments representing the following views:\n   * - discover[@genre=...][@subgenre=...][@sortBy=...][@artistRecommendationType=...][@location=...][@format=...][@time=...][@pageRef=...]\n   * - album[@albumUrl=...]\n   * - search[@query=...][@itemType=...][@pageRef=...]\n   * - band[@bandUrl=...][band.type==='label': @view=artists|discography][@pageRef=...]*\n   * - track[@trackUrl=...]\n   * - shows[@showUrl=...|@pageRef=...][@view=tracks|albums]\n   * - tag[@tagUrl=...][@select=...][@format=...][@location=...][@sort=...][@pageRef=...]\n   * - fan[@username=...][@view=collection|wishlist|followingArtistsAndLabels|followingGenres][@pageRef=...]\n   *\n   * *Replaces obsolete 'artist' and 'label' views\n   */\n  async browseUri(uri: string): Promise<RenderedPage> {\n    bandcamp.getLogger().info(`[bandcamp-browse] browseUri: ${uri}`);\n\n    const handler = this.#getHandler(uri);\n    return handler.browse();\n  }\n\n  /**\n   * Explodable uris:\n   * - track[@trackUrl=...]\n   * - album[@albumUrl=...]\n   * - shows[@showUrl=...]\n   */\n  explodeUri(uri: string): Promise<ExplodedTrackInfo[]> {\n    bandcamp.getLogger().info(`[bandcamp-browse] explodeUri: ${uri}`);\n\n    const handler = this.#getHandler(uri);\n    return handler.explode();\n  }\n\n  #getHandler<V extends View>(uri: string): BaseViewHandler<V> {\n    return ViewHandlerFactory.getHandler(uri);\n  }\n}\n"]}