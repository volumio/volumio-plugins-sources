{"version":3,"file":"UIHelper.js","sourceRoot":"","sources":["../../../src/lib/util/UIHelper.ts"],"names":[],"mappings":"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","sourcesContent":["import { existsSync } from 'fs';\nimport bandcamp from '../BandcampContext';\n\nexport interface UILink {\n  icon?: {\n    type: 'fa' | 'bandcamp',\n    float?: string,\n    color?: string,\n    class?: string\n  };\n  target?: string;\n  text: string;\n  url: string;\n  onclick?: string;\n}\n\nexport interface UIDoubleLine {\n  imgSrc?: string;\n  title: string;\n  secondaryTitle: string;\n  link: UILink;\n}\n\nexport const UI_STYLES = {\n  NON_PLAYABLE: 'color: #b38536; font-size: 10px; padding-right: 8px;',\n  NEXT_PAGE: 'color: #7a848e;',\n  LIST_ITEM_SELECTED: 'color: #54c688; font-weight: bold;',\n  RESOURCE_TYPE: 'color: #999; font-size: 10px; padding-right: 8px;',\n  ARTICLE_SECTION: {\n    TEXT: 'color: #ddd; font-size: 16px; line-height: 24px; padding: 16px 0px 48px 0px; text-align: justify;',\n    MEDIA_ITEM_NAME: 'font-size: 16px; font-weight: bold; font-style: italic;',\n    MEDIA_ITEM_ARTIST: 'font-size: 16px; font-weight: bold;'\n  }\n};\n\nexport default class UIHelper {\n\n  static getBandcampIcon() {\n    return `<img src=\"/albumart?sourceicon=${encodeURIComponent('music_service/bandcamp/dist/assets/images/bandcamp.svg')}\" style=\"width: 23px; height: 23px; margin-right: 8px; margin-top: -3px;\" />`;\n  }\n  static addBandcampIconToListTitle(s: string) {\n    if (!this.supportsEnhancedTitles()) {\n      return s;\n    }\n    return `${this.getBandcampIcon()}${s}`;\n  }\n\n  static addIconToListTitle(faClass: string, s: string) {\n    if (!this.supportsEnhancedTitles()) {\n      return s;\n    }\n    return `<i class=\"${faClass}\" style=\"padding-right: 15px;\"></i>${s}`;\n  }\n\n  static styleText(s: string, style?: string) {\n    return `<span${style ? ` style='${style}'` : ''}>${s}</span>`;\n  }\n\n  static wrapInDiv(s: string, style?: string) {\n    return `<div${style ? ` style='${style}'` : ''}>${s}</div>`;\n  }\n\n  static addTextBefore(s: string, textToAdd: string, style?: string) {\n    return this.styleText(textToAdd, style) + s;\n  }\n\n  static addNonPlayableText(s: string) {\n    return this.addTextBefore(s, bandcamp.getI18n('BANDCAMP_NON_PLAYABLE'), UI_STYLES.NON_PLAYABLE);\n  }\n\n  static getMoreText() {\n    return this.styleText(bandcamp.getI18n('BANDCAMP_MORE'), UI_STYLES.NEXT_PAGE);\n  }\n\n  static constructListTitleWithLink(title: string, links: UILink | UILink[], isFirstList: boolean) {\n    if (!this.supportsEnhancedTitles()) {\n      return title;\n    }\n    let html = `<div style=\"display: flex; width: 100%; align-items: flex-end;${isFirstList ? '' : ' margin-top: -24px;'}\">\n                    <div>${title}</div>\n                    <div style=\"flex-grow: 1; text-align: right; font-size: small;\">`;\n\n    if (Array.isArray(links)) {\n      links.forEach((link, index) => {\n        html += this.#constructLinkItem(link);\n        if (index < links.length - 1) {\n          html += '<span style=\"padding: 0px 5px;\">|</span>';\n        }\n      });\n    }\n    else {\n      html += this.#constructLinkItem(links);\n    }\n\n    html += '</div></div>';\n\n    return html;\n  }\n\n  static #constructLinkItem(link: UILink) {\n    let html = '';\n    if (link.icon) {\n      if (link.icon.type === 'fa' && link.icon.float !== 'right') {\n        html += `<i class=\"${link.icon.class}\" style=\"position: relative; top: 1px; margin-right: 2px; font-size: 16px;${link.icon.color ? ` color: ${link.icon.color};` : ''}\"></i>`;\n      }\n      else if (link.icon.type === 'bandcamp') {\n        html += `<img src=\"/albumart?sourceicon=${encodeURIComponent('music_service/bandcamp/dist/assets/images/bandcamp.svg')}\" style=\"width: 23px; height: 23px; margin-top: -3px;\" />`;\n      }\n    }\n    html += `<a${link.target ? ` target=\"${link.target}\"` : ''} href=\"${link.url}\"${link.onclick ? ` onclick=\"${link.onclick}\"` : ''}>\n                    ${link.text}\n                </a>`;\n    if (link.icon && link.icon.type === 'fa' && link.icon.float === 'right') {\n      html += `<i class=\"${link.icon.class}\" style=\"position: relative; top: 1px; margin-left: 2px; font-size: 16px;${link.icon.color ? ` color: ${link.icon.color};` : ''}\"></i>`;\n    }\n\n    return html;\n  }\n\n  static constructDoubleLineTitleWithImageAndLink(params: UIDoubleLine) {\n    if (!this.supportsEnhancedTitles()) {\n      return params.title;\n    }\n    const { imgSrc, title, secondaryTitle, link } = params;\n    const imgHtml = imgSrc ? `<div>\n            <img src=\"${imgSrc}\" style=\"width: 48px; height: 48px; margin-right: 12px; margin-top: -3px; border-radius: 50%;\"></div>`\n      : '';\n\n    return `\n        <div style=\"display: flex; width: 100%; align-items: center;\">\n            ${imgHtml}\n            <div style=\"flex-grow: 1\">\n                <div>${title}</div>\n                <div style=\"color: #9c9c9c; font-size: 14px; padding-top: 3px;\">${secondaryTitle}</div>\n            </div>\n            <div style=\"text-align: right; font-size: small;\">\n                ${this.#constructLinkItem(link)}\n            </div>\n        </div>\n        `;\n  }\n\n  static reformatDate(date: string) {\n    return new Date(Date.parse(date)).toLocaleDateString();\n  }\n\n  static supportsEnhancedTitles() {\n    return !this.isManifestUI();\n  }\n\n  static isManifestUI() {\n    const volumioManifestUIDir = '/volumio/http/www4';\n    const volumioManifestUIDisabledFile = '/data/disableManifestUI';\n    return existsSync(volumioManifestUIDir) && !existsSync(volumioManifestUIDisabledFile);\n  }\n}\n"]}