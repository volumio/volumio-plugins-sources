{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport libQ from 'kew';\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport vconf from 'v-conf';\n\nimport yt2 from './lib/YouTube2Context';\nimport BrowseController from './lib/controller/browse';\nimport SearchController, { type SearchQuery } from './lib/controller/search/SearchController';\nimport PlayController from './lib/controller/play/PlayController';\nimport { jsPromiseToKew, kewToJSPromise } from './lib/util';\nimport Model, { ModelType } from './lib/model';\nimport { type I18nOptionValue, type I18nOptions } from './lib/types/PluginConfig';\nimport { type QueueItem } from './lib/controller/browse/view-handlers/ExplodableViewHandler';\nimport ViewHelper from './lib/controller/browse/view-handlers/ViewHelper';\nimport InnertubeLoader from './lib/model/InnertubeLoader';\nimport { type NowPlayingPluginSupport } from 'now-playing-common';\nimport YouTube2NowPlayingMetadataProvider from './lib/util/YouTube2NowPlayingMetadataProvider';\nimport { Parser } from 'volumio-youtubei.js';\n\ninterface GotoParams extends QueueItem {\n  type: 'album' | 'artist';\n}\n\nclass ControllerYouTube2 implements NowPlayingPluginSupport {\n  #context: any;\n  #config: any;\n  #commandRouter: any;\n\n  #browseController: BrowseController | null;\n  #searchController: SearchController | null;\n  #playController: PlayController | null;\n\n  #nowPlayingMetadataProvider: YouTube2NowPlayingMetadataProvider | null;\n\n  constructor(context: any) {\n    this.#context = context;\n    this.#commandRouter = context.coreCommand;\n  }\n\n  getUIConfig() {\n    const defer = libQ.defer();\n\n    const langCode = this.#commandRouter.sharedVars.get('language_code');\n    const loadConfigPromises = [\n      kewToJSPromise(this.#commandRouter.i18nJson(`${__dirname}/i18n/strings_${langCode}.json`,\n        `${__dirname}/i18n/strings_en.json`,\n        `${__dirname}/UIConfig.json`)),\n      this.#getConfigI18nOptions(),\n      this.#getConfigAccountInfo()\n    ] as const;\n\n    const configModel = Model.getInstance(ModelType.Config);\n\n    Promise.all(loadConfigPromises)\n      .then(([ uiconf, i18nOptions, account ]) => {\n        const i18nUIConf = uiconf.sections[0];\n        const accountUIConf = uiconf.sections[1];\n        const browseUIConf = uiconf.sections[2];\n        const playbackUIConf = uiconf.sections[3];\n        const ytPlaybackModeConf = uiconf.sections[4];\n\n        // I18n\n        // -- region\n        i18nUIConf.content[0].label = i18nOptions.options.region?.label;\n        i18nUIConf.content[0].options = i18nOptions.options.region?.optionValues;\n        i18nUIConf.content[0].value = i18nOptions.selected.region;\n        i18nUIConf.content[1].label = i18nOptions.options.language?.label;\n        i18nUIConf.content[1].options = i18nOptions.options.language?.optionValues;\n        i18nUIConf.content[1].value = i18nOptions.selected.language;\n\n        // Account\n        const cookie = yt2.getConfigValue('cookie');\n        let authStatusDescription;\n        if (account?.isSignedIn && account.active) {\n          authStatusDescription = yt2.getI18n('YOUTUBE2_AUTH_STATUS_SIGNED_IN_AS', account.active.name);\n          if (account.list.length > 1) {\n            const accountSelect = {\n              id: 'activeChannelHandle',\n              element: 'select',\n              label: yt2.getI18n('YOUTUBE2_ACTIVE_CHANNEL'),\n              value: {\n                label: account.active.name,\n                value: account.active.handle\n              },\n              options: account.list.map((ac) => ({\n                label: ac.name,\n                value: ac.handle\n              }))\n            };\n            accountUIConf.content = [\n              accountUIConf.content[0],\n              accountSelect,\n              ...accountUIConf.content.slice(1)\n            ];\n            accountUIConf.saveButton.data.push('activeChannelHandle');\n          }\n        }\n        else if (cookie) {\n          authStatusDescription = yt2.getI18n('YOUTUBE2_AUTH_STATUS_SIGNED_OUT');\n        }\n        accountUIConf.description = authStatusDescription;\n        accountUIConf.content[0].value = cookie;\n\n        // Browse\n        const rootContentType = yt2.getConfigValue('rootContentType');\n        const rootContentTypeOptions = configModel.getRootContentTypeOptions();\n        const loadFullPlaylists = yt2.getConfigValue('loadFullPlaylists');\n        browseUIConf.content[0].options = rootContentTypeOptions;\n        browseUIConf.content[0].value = rootContentTypeOptions.find((o) => o.value === rootContentType);\n        browseUIConf.content[1].value = loadFullPlaylists;\n\n        // Playback\n        const autoplay = yt2.getConfigValue('autoplay');\n        const autoplayClearQueue = yt2.getConfigValue('autoplayClearQueue');\n        const autoplayPrefMixRelated = yt2.getConfigValue('autoplayPrefMixRelated');\n        const addToHistory = yt2.getConfigValue('addToHistory');\n        const liveStreamQuality = yt2.getConfigValue('liveStreamQuality');\n        const liveStreamQualityOptions = configModel.getLiveStreamQualityOptions();\n        const prefetchEnabled = yt2.getConfigValue('prefetch');\n        playbackUIConf.content[0].value = autoplay;\n        playbackUIConf.content[1].value = autoplayClearQueue;\n        playbackUIConf.content[2].value = autoplayPrefMixRelated;\n        playbackUIConf.content[3].value = addToHistory;\n        playbackUIConf.content[4].options = liveStreamQualityOptions;\n        playbackUIConf.content[4].value = liveStreamQualityOptions.find((o) => o.value === liveStreamQuality);\n        playbackUIConf.content[5].value = prefetchEnabled;\n\n        // YouTube Playback Mode\n        const ytPlaybackMode = yt2.getConfigValue('ytPlaybackMode');\n        ytPlaybackModeConf.content[0].value = ytPlaybackMode.feedVideos;\n        ytPlaybackModeConf.content[1].value = ytPlaybackMode.playlistVideos;\n\n        defer.resolve(uiconf);\n      })\n      .catch((error: unknown) => {\n        yt2.getLogger().error(yt2.getErrorMessage(`[youtube2] getUIConfig(): Cannot populate YouTube2 configuration:`, error));\n        defer.reject(Error());\n      }\n      );\n\n    return defer.promise;\n  }\n\n  onVolumioStart() {\n    const configFile = this.#commandRouter.pluginManager.getConfigurationFile(this.#context, 'config.json');\n    this.#config = new vconf();\n    this.#config.loadFile(configFile);\n    return libQ.resolve();\n  }\n\n  onStart() {\n    yt2.init(this.#context, this.#config);\n\n    this.#browseController = new BrowseController();\n    this.#searchController = new SearchController();\n    this.#playController = new PlayController();\n\n    this.#nowPlayingMetadataProvider = new YouTube2NowPlayingMetadataProvider();\n    Parser.setParserErrorHandler(() => null); // Disable Innertube parser error reporting\n\n    this.#addToBrowseSources();\n\n    return libQ.resolve();\n  }\n\n  onStop() {\n    this.#commandRouter.volumioRemoveToBrowseSources('YouTube2');\n\n    this.#playController?.reset();\n\n    this.#browseController = null;\n    this.#searchController = null;\n    this.#playController = null;\n\n    this.#nowPlayingMetadataProvider = null;\n\n    InnertubeLoader.reset();\n    yt2.reset();\n\n    return libQ.resolve();\n  }\n\n  getConfigurationFiles() {\n    return [ 'config.json' ];\n  }\n\n  async #getConfigI18nOptions() {\n    const model = Model.getInstance(ModelType.Config);\n    const selected: Record<keyof I18nOptions, I18nOptionValue> = {\n      region: { label: '', value: '' },\n      language: { label: '', value: '' }\n    };\n    try {\n      const options = await model.getI18nOptions();\n      const selectedValues = {\n        region: yt2.getConfigValue('region'),\n        language: yt2.getConfigValue('language')\n      };\n\n      (Object.keys(selected) as (keyof I18nOptions)[]).forEach((key) => {\n        selected[key] = options[key]?.optionValues.find((ov) => ov.value === selectedValues[key]) || { label: '', value: selectedValues[key] };\n      });\n\n      return {\n        options,\n        selected\n      };\n    }\n    catch (error: unknown) {\n      yt2.getLogger().error(yt2.getErrorMessage('[youtube2] Error getting i18n options:', error));\n      yt2.toast('warning', 'Could not obtain i18n options');\n      return {\n        options: model.getDefaultI18nOptions(),\n        selected\n      };\n    }\n  }\n\n  #getConfigAccountInfo() {\n    const model = Model.getInstance(ModelType.Account);\n    try {\n      return model.getInfo();\n    }\n    catch (error: unknown) {\n      yt2.getLogger().warn(yt2.getErrorMessage('[youtube2] Failed to get account config:', error));\n      return null;\n    }\n  }\n\n  configSaveI18n(data: any) {\n    const oldRegion = yt2.hasConfigKey('region') ? yt2.getConfigValue('region') : null;\n    const oldLanguage = yt2.hasConfigKey('language') ? yt2.getConfigValue('language') : null;\n    const region = data.region.value;\n    const language = data.language.value;\n\n    if (oldRegion !== region || oldLanguage !== language) {\n      yt2.setConfigValue('region', region);\n      yt2.setConfigValue('language', language);\n\n      InnertubeLoader.applyI18nConfig();\n      Model.getInstance(ModelType.Config).clearCache();\n      yt2.refreshUIConfig();\n    }\n\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n  }\n\n  configSaveAccount(data: any) {\n    const oldCookie = yt2.hasConfigKey('cookie') ? yt2.getConfigValue('cookie') : null;\n    const cookie = data.cookie?.trim();\n    const oldActiveChannelHandle = yt2.getConfigValue('activeChannelHandle');\n    const activeChannelHandle = data.activeChannelHandle?.value || '';\n    let resetInnertube = false;\n    if (oldCookie !== cookie) {\n      yt2.setConfigValue('cookie', cookie);\n      yt2.deleteConfigValue('activeChannelHandle');\n      resetInnertube = true;\n    }\n    else if (oldActiveChannelHandle !== activeChannelHandle) {\n      yt2.setConfigValue('activeChannelHandle', activeChannelHandle);\n      resetInnertube =  true;\n    }\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n    if (resetInnertube) {\n      InnertubeLoader.reset();\n      yt2.refreshUIConfig();\n    }\n  }\n\n  configSaveBrowse(data: any) {\n    yt2.setConfigValue('rootContentType', data.rootContentType.value);\n    yt2.setConfigValue('loadFullPlaylists', data.loadFullPlaylists);\n\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n  }\n\n  configSavePlayback(data: any) {\n    yt2.setConfigValue('autoplay', data.autoplay);\n    yt2.setConfigValue('autoplayClearQueue', data.autoplayClearQueue);\n    yt2.setConfigValue('autoplayPrefMixRelated', data.autoplayPrefMixRelated);\n    yt2.setConfigValue('addToHistory', data.addToHistory);\n    yt2.setConfigValue('liveStreamQuality', data.liveStreamQuality.value);\n    yt2.setConfigValue('prefetch', data.prefetch);\n\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n\n    this.#configCheckAutoplay();\n  }\n\n  #configCheckAutoplay() {\n    const addToHistory = yt2.getConfigValue('addToHistory');\n    const autoplay = yt2.getConfigValue('autoplay');\n\n    if (autoplay && !addToHistory) {\n      const modalData = {\n        title: yt2.getI18n('YOUTUBE2_AUTOPLAY'),\n        message: yt2.getI18n('YOUTUBE2_MSG_AUTOPLAY_ADD_TO_HISTORY'),\n        size: 'lg',\n        buttons: [\n          {\n            name: yt2.getI18n('YOUTUBE2_CONFIRM_ADD_TO_HISTORY'),\n            class: 'btn btn-info',\n            emit: 'callMethod',\n            payload: {\n              endpoint: 'music_service/youtube2',\n              method: 'configEnableAddToHistory'\n            }\n          },\n          {\n            name: yt2.getI18n('YOUTUBE2_NO'),\n            class: 'btn'\n          }\n        ]\n      };\n\n      this.#commandRouter.broadcastMessage('openModal', modalData);\n    }\n  }\n\n  configEnableAddToHistory() {\n    yt2.setConfigValue('addToHistory', true);\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n    yt2.refreshUIConfig();\n  }\n\n  configSaveYouTubePlaybackMode(data: any) {\n    yt2.setConfigValue('ytPlaybackMode', {\n      feedVideos: data.feedVideos,\n      playlistVideos: data.playlistVideos\n    });\n\n    yt2.toast('success', yt2.getI18n('YOUTUBE2_SETTINGS_SAVED'));\n  }\n\n  #addToBrowseSources() {\n    const source = {\n      name: 'YouTube2',\n      uri: 'youtube2',\n      plugin_type: 'music_service',\n      plugin_name: 'youtube2',\n      albumart: '/albumart?sourceicon=music_service/youtube2/dist/assets/images/youtube.svg'\n    };\n    this.#commandRouter.volumioAddToBrowseSources(source);\n  }\n\n  handleBrowseUri(uri: string) {\n    if (!this.#browseController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return jsPromiseToKew(this.#browseController.browseUri(uri));\n  }\n\n  explodeUri(uri: string) {\n    if (!this.#browseController) {\n      return libQ.reject('YouTube2 Discover plugin is not started');\n    }\n    return jsPromiseToKew(this.#browseController.explodeUri(uri));\n  }\n\n  clearAddPlayTrack(track: any) {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return jsPromiseToKew(this.#playController.clearAddPlayTrack(track));\n  }\n\n  stop() {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.stop();\n  }\n\n  pause() {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.pause();\n  }\n\n  resume() {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.resume();\n  }\n\n  seek(position: number) {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.seek(position);\n  }\n\n  next() {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.next();\n  }\n\n  previous() {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return this.#playController.previous();\n  }\n\n  prefetch(track: QueueItem) {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return jsPromiseToKew(this.#playController.prefetch(track));\n  }\n\n  search(query: SearchQuery) {\n    if (!this.#searchController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n    return jsPromiseToKew(this.#searchController.search(query));\n  }\n\n  goto(data: GotoParams) {\n    if (!this.#playController) {\n      return libQ.reject('YouTube2 plugin is not started');\n    }\n\n    const defer = libQ.defer();\n\n    this.#playController.getGotoUri(data.type, data.uri).then((uri) => {\n      if (uri) {\n        if (!this.#browseController) {\n          return libQ.reject('YouTube2 plugin is not started');\n        }\n        defer.resolve(this.#browseController.browseUri(uri));\n      }\n      else {\n        const view = ViewHelper.getViewsFromUri(data.uri)?.[1];\n        const trackData = view?.explodeTrackData || null;\n        const trackTitle = trackData?.title;\n        let errMsg;\n        if (data.type === 'album') {\n          errMsg = trackTitle ? yt2.getI18n('YOUTUBE2_ERR_GOTO_PLAYLIST_NOT_FOUND_FOR', trackTitle) :\n            yt2.getI18n('YOUTUBE2_ERR_GOTO_PLAYLIST_NOT_FOUND');\n        }\n        else if (data.type === 'artist') {\n          errMsg = trackTitle ? yt2.getI18n('YOUTUBE2_ERR_GOTO_CHANNEL_NOT_FOUND_FOR', trackTitle) :\n            yt2.getI18n('YOUTUBE2_ERR_GOTO_CHANNEL_NOT_FOUND');\n        }\n        else {\n          errMsg = yt2.getI18n('YOUTUBE2_ERR_GOTO_UNKNOWN_TYPE', data.type);\n        }\n\n        yt2.toast('error', errMsg);\n        defer.reject(Error(errMsg));\n      }\n    })\n    .catch((error: unknown) => {\n      yt2.getLogger().error(yt2.getErrorMessage('[youtube2] Error obtaining goto URL:', error));\n    });\n\n    return defer.promise;\n  }\n\n  getNowPlayingMetadataProvider() {\n    return this.#nowPlayingMetadataProvider;\n  }\n}\n\nexport = ControllerYouTube2;\n"]}